---
description: Extract learnings from session feedback and update LEARNINGS.md
---

# Learn Command

Analyze the current session conversation, extract user feedback and corrections, classify them by impact level, and persist valuable learnings.

## Trigger Modes

- **Manual**: User invokes `/learn` at any time
- **Hook**: Automatically triggered at session end (Stop hook)

## Workflow

### Step 1: Read Current Session

Use `session_read` to get the full conversation history of the current session.

```
session_read(session_id=current, include_todos=true)
```

### Step 2: Read Existing Context

Read these files to understand current guidelines (if they exist):
- `./AGENTS.md` - Project-specific agent guidelines
- `./CLAUDE.md` - Project-specific context
- `~/.claude/CLAUDE.md` - Global user preferences
- `./LEARNINGS.md` - Previously captured learnings

### Step 3: Analyze for Feedback Patterns

Scan the conversation for:

1. **Explicit corrections**: "No, don't do X", "Always do Y first", "Stop adding comments"
2. **Preference statements**: "I prefer X", "We use Y pattern here", "Follow the existing Z"
3. **Process guidance**: "Run tests before coding", "Check the design system first"
4. **Repeated requests**: Same feedback given multiple times indicates importance
5. **Style corrections**: "Remove these comments", "Match the existing component style"

### Step 4: Classify Feedback

| Level | Criteria | Examples | Persistence |
|-------|----------|----------|-------------|
| **HIGH** | Process/workflow changes, repeated corrections, explicit rules | "Always run tests first", "Never commit without verification", "Use TDD" | Always persist |
| **MEDIUM** | Style/consistency preferences, architecture patterns | "No comments in code", "Follow existing UX patterns", "Maintain component structure" | Persist with confirmation |
| **LOW** | One-time tactical fixes, context-specific corrections | "Fix this typo", "Use hippo color here", "Align this button" | Do NOT persist (too specific) |

### Step 5: Check Confirmation Mode

Read `./LEARNINGS.md` header for confirmation mode:
- If `auto_confirm: true` is set, skip confirmation for MEDIUM level
- If `auto_confirm: false` or not set, require confirmation for MEDIUM level
- HIGH level learnings always persist (no confirmation needed)
- LOW level learnings never persist

### Step 6: Format Learnings

For each HIGH/MEDIUM learning, format as:

```markdown
### [CATEGORY] Brief Title
- **Level**: HIGH | MEDIUM
- **Session**: {session_id}
- **Date**: {ISO date}
- **Context**: One-line description of when this feedback was given
- **Learning**: The actual rule/preference to remember
```

Categories:
- `PROCESS` - Workflow and methodology
- `CODE_STYLE` - Code formatting, comments, naming
- `ARCHITECTURE` - Design patterns, structure
- `UI_UX` - Frontend patterns, design system
- `TESTING` - Test strategy, verification
- `TOOLING` - Tool usage, commands

### Step 7: Present Diff (if confirmation needed)

If confirmation is required:
1. Show the proposed additions to `LEARNINGS.md`
2. Ask: "Apply these learnings? (y/n/never-ask)"
3. If "never-ask": Set `auto_confirm: true` in LEARNINGS.md header

### Step 8: Write to LEARNINGS.md

Append new learnings to `./LEARNINGS.md`. Create the file if it doesn't exist with this template:

```markdown
# Project Learnings

<!-- 
  Auto-generated by /learn skill
  auto_confirm: false
-->

## Summary

Quick reference of key learnings for this project.

---

## Learnings

<!-- New learnings are appended below -->
```

### Step 9: Report Summary

Output a brief summary:
- Number of learnings captured (by level)
- Files updated
- Confirmation status

## Self-Learning: Confirmation Toggle

The skill tracks its own confirmation preference:

1. **Initial state**: `auto_confirm: false` - always ask for MEDIUM level
2. **After "never-ask"**: `auto_confirm: true` - auto-apply MEDIUM level
3. **Reset**: User can manually edit LEARNINGS.md header to reset

## Rules

1. **Never persist LOW level feedback** - too context-specific
2. **Always persist HIGH level feedback** - important process rules
3. **Deduplicate** - don't add learnings that already exist
4. **Be concise** - learnings should be actionable, not verbose
5. **Respect existing files** - read AGENTS.md/CLAUDE.md but don't modify them
6. **Create LEARNINGS.md if missing** - use the template above

## Hook Configuration

To enable automatic learning at session end, configure in `oh-my-opencode.json`:

```json
{
  "hooks": {
    "Stop": ["/learn"]
  }
}
```

Or in `.opencode/hooks/Stop.md`:
```markdown
Run /learn to capture session feedback before closing.
```
